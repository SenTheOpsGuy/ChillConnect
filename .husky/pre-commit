#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run lint-staged
npx lint-staged

# Run type checking for frontend if TypeScript is used
if [ -f "frontend/tsconfig.json" ]; then
  echo "ğŸ”§ Type checking frontend..."
  cd frontend && npx tsc --noEmit && cd ..
fi

# Run type checking for backend if TypeScript is used
if [ -f "backend/tsconfig.json" ]; then
  echo "ğŸ”§ Type checking backend..."
  cd backend && npx tsc --noEmit && cd ..
fi

# Run security checks
echo "ğŸ”’ Running security checks..."
npm run security:check

# Run unit tests
echo "ğŸ§ª Running unit tests..."
npm run test:backend

echo "âœ… Pre-commit checks completed!"